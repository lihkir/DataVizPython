

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Errores comunes al crear visualizaciones interactivas &#8212; Visualización de Datos con Python y R</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'common_errors';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Predicción de series de tiempo" href="predictive_model.html" />
    <link rel="prev" title="Visualización interactiva de datos geográficos" href="geo_dataviz.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo_uninorte.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo_uninorte.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dataviz_intro.html">Introducción a la visualización de datos con Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="static_dataviz.html">Visualización estática</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_dataviz.html">De la visualización estática a la interactiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="stratified_dataviz.html">Visualización de datos a través de estratos</a></li>
<li class="toctree-l1"><a class="reference internal" href="geo_dataviz.html">Visualización interactiva de datos geográficos</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Errores comunes al crear visualizaciones interactivas</a></li>

<li class="toctree-l1"><a class="reference internal" href="predictive_model.html">Predicción de series de tiempo</a></li>

<li class="toctree-l1"><a class="reference internal" href="postgresql.html">Introducción a PostreSQL y Docker</a></li>




<li class="toctree-l1"><a class="reference internal" href="dash_dataviz.html">Introducción a <code class="docutils literal notranslate"><span class="pre">Dash</span></code></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fcommon_errors.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/common_errors.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Errores comunes al crear visualizaciones interactivas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Errores comunes al crear visualizaciones interactivas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">Introducción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formato-e-interpretacion-de-datos">Formato e interpretación de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-valores-atipicos-en-un-conjunto-de-datos-con-un-grafico-de-cajas">Visualización de valores atípicos en un conjunto de datos con un gráfico de cajas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#como-tratar-los-valores-atipicos">Cómo tratar los valores atípicos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamiento-de-los-valores-atipicos">Tratamiento de los valores atípicos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamiento-de-los-valores-faltantes">Tratamiento de los valores faltantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-multiple-iterativa">Imputación múltiple iterativa</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-de-iterativeimputer">Aplicación de IterativeImputer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativeimputer-y-evaluacion-de-modelos">IterativeImputer y evaluación de modelos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativeimputer-y-diferente-orden-de-imputacion">IterativeImputer y diferente orden de imputación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativeimputer-y-diferente-numero-de-iteraciones">IterativeImputer y diferente número de iteraciones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativeimputer-al-hacer-una-prediccion">IterativeImputer al hacer una predicción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instancias-y-o-funciones-duplicadas">Instancias y/o funciones duplicadas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mala-seleccion-de-caracteristicas">Mala selección de características</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-para-entregar">Ejercicio para entregar</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="errores-comunes-al-crear-visualizaciones-interactivas">
<h1>Errores comunes al crear visualizaciones interactivas<a class="headerlink" href="#errores-comunes-al-crear-visualizaciones-interactivas" title="Permalink to this heading">#</a></h1>
<div class="admonition-objetivos admonition">
<p class="admonition-title">Objetivos</p>
<ul class="simple">
<li><p>Identificar los errores que se cometen al crear visualizaciones</p></li>
<li><p>Aplicar técnicas para <strong>corregir los errores y crear visualizaciones eficaces</strong></p></li>
<li><p>Seleccionar y <strong>diseñar las visualizaciones adecuadas para determinados tipos de datos</strong></p></li>
<li><p>Describir las diferentes bibliotecas y herramientas disponibles para producir visualizaciones</p></li>
</ul>
</div>
<section id="introduccion">
<h2>Introducción<a class="headerlink" href="#introduccion" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>En éste capítulo se enumera y explica los posibles fallos y errores que se cometen durante varias etapas del proceso de visualización de datos, como la <strong>visualización de elementos no correlacionados de un conjunto de datos</strong> para mostrar una relación o <strong>crear una característica interactiva inapropiada</strong>.</p></li>
<li><p>El proceso de visualización de datos puede parecer sencillo: tome algunos datos, trace algunos gráficos, añadir algunas características interactivas, y el trabajo está hecho. O, tal vez, no lo sea: podría haber varios lugares durante el trayecto en los que se pueden cometer errores. Estos errores terminan por dar lugar a una <strong>visualización defectuosa que no puede de manera fácil y eficaz transmitir lo que dicen los datos</strong>, lo que hace que sea completamente inútil para el público que lo está viendo.</p></li>
</ul>
</section>
<section id="formato-e-interpretacion-de-datos">
<h2>Formato e interpretación de datos<a class="headerlink" href="#formato-e-interpretacion-de-datos" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>La primera fase de la visualización de datos es <strong>entender los datos frente a ti: entender lo que es, lo que significa y lo que transmite</strong>. Solo cuando entiendas los datos serás capaz de diseñar una visualización que ayude a otros a entenderlos.</p></li>
<li><p>Además, es importante <strong>asegurarse de que los datos tienen sentido y contienen suficiente información, ya sea categórica, numérica o una mezcla de ambas</strong>, para ser visualizados. Por lo tanto, si tratas con datos erróneos o sucios, es probable que la visualización sea defectuosa.</p></li>
<li><p>En esta siguiente sección, veremos algunas formas de evitar los errores comunes que se suelen cometidos en esta fase de los datos y cómo evitarlos.</p></li>
</ul>
<p><strong>¿Cómo evitar los errores más comunes al tratar con datos sucios?</strong></p>
<ul class="simple">
<li><p><strong>Garbage In, Garbage Out</strong>: Este es un dicho popular en el campo de la ciencia de datos, especialmente con respecto a la visualización de datos. Básicamente, significa que <strong>si utilizas datos desordenados y ruidosos, vas a obtener una visualización defectuosa y poco informativa</strong>. Los datos desordenados, ruidosos y sucios corresponden a una serie de problemas que se encuentran en los datos. Vamos a discutir los problemas uno por uno y las formas de tratar este tipo de datos.</p></li>
</ul>
<p><strong>Valores atípicos</strong></p>
<ul class="simple">
<li><p>Los datos que contienen valores inexactos o instancias que son <em>significativamente diferentes del resto de los datos de un dataset</em> se denominan valores atípicos. Estos valores atípicos pueden ser auténticos, es decir, parecen incorrectos, pero en realidad no lo son, o son <strong>errores que se cometen al recoger o almacenar los datos</strong>.</p></li>
<li><p>Veamos un ejemplo de un error cometido al recoger o almacenar los datos. La siguiente tabla muestra la <em>edad, el peso y el sexo de los clientes que acuden a un determinado gimnasio</em>. La columna de sexo consta de tres valores discretos <em>0, 1 y 2 que corresponden todos a una clase: hombre, mujer y otro</em>, respectivamente. La columna de la edad se expresa en años y la columna de peso está en kilogramos</p></li>
</ul>
<figure class="align-center">
<img alt="_images/Figure701.png" src="_images/Figure701.png" />
</figure>
<ul class="simple">
<li><p>Todo parece correcto hasta que llegamos a la cuarta instancia (índice 3), donde el peso es de 790 kg. <em>Esto parece extraño porque nadie puede pesar realmente 790 kg, especialmente alguien cuya estatura es de 1,5 metros y 7 pulgadas</em>. Quien haya almacenado estos datos <em>debe haber querido decir 79 kg y haber añadido un 0 por error</em>.</p></li>
<li><p>Este es un caso de un valor atípico en el conjunto de datos. Esto puede parecer trivial en este momento, sin embargo, <em>esto puede resultar en visualizaciones y predicciones o patrones de modelos de aprendizaje automático defectuosos</em>, especialmente si hay múltiples repeticiones de esos datos. Ahora, veamos un ejemplo de un auténtico valor atípico en la siguiente tabla.</p></li>
</ul>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/Figure702.png"><img alt="_images/Figure702.png" src="_images/Figure702.png" style="width: 286.40000000000003px; height: 251.20000000000002px;" /></a>
</figure>
<ul class="simple">
<li><p>El peso en el cuarto caso (índice 3) es de <em>167 kilogramos, lo que parece extrañamente alto. Sin embargo, sigue siendo un valor verosímil, ya que es posible que alguien tenga un peso de 167 kilogramos a los 37 años</em>. Por lo tanto, se trata de un <em>verdadero valor atípico</em>. Mientras que en los ejemplos anteriores es fácil detectar el valor atípico, ya que solo hay 5 casos, en realidad, nuestros conjuntos de datos son masivos, por lo que comprobar cada caso es una tarea tediosa y poco práctica.</p></li>
<li><p>En consecuencia, en la vida real, podemos utilizar visualizaciones estáticas básicas, como los <em>gráficos de caja</em>, para observar la existencia de valores atípicos. Los gráficos de caja son visualizaciones de datos sencillas, pero informativas que pueden decirnos mucho sobre la forma en que se distribuyen nuestros datos. Muestran el rango de nuestros datos basándose en cinco valores clave:</p>
<ul>
<li><p>El valor mínimo de la columna</p></li>
<li><p>El primer cuartil</p></li>
<li><p>La mediana</p></li>
<li><p>El tercer cuartil</p></li>
<li><p>El valor máximo de la columna</p></li>
</ul>
</li>
<li><p>Esto es lo que hace que sean excelentes para <strong>mostrar los valores atípicos, además de describir la simetría de los datos, el grado de agrupación de los mismos</strong> (si todos los valores están repartidos en un amplio rango), <strong>y si están o no sesgados</strong>.</p></li>
</ul>
</section>
<section id="visualizacion-de-valores-atipicos-en-un-conjunto-de-datos-con-un-grafico-de-cajas">
<h2>Visualización de valores atípicos en un conjunto de datos con un gráfico de cajas<a class="headerlink" href="#visualizacion-de-valores-atipicos-en-un-conjunto-de-datos-con-un-grafico-de-cajas" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>En este ejercicio, vamos a crear un gráfico de caja para comprobar si nuestro conjunto de datos contiene valores atípicos. Vamos a utilizar el conjunto de datos <em>gym.csv</em>, que contiene información sobre los clientes de un determinado gimnasio.</p></li>
</ul>
<ul class="simple">
<li><p>Importar las librerías necesarias</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Guarda el archivo <em>gym.csv</em> en un DataFrame llamado <strong>gym</strong>, e imprime las cinco primeras filas del mismo para ver cómo son los datos</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gym</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/gym.csv&#39;</span><span class="p">)</span>
<span class="n">gym</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Como puede ver, nuestros datos tienen tres columnas: <code class="docutils literal notranslate"><span class="pre">age,</span> <span class="pre">weight,</span> <span class="pre">sex</span></code>. La columna sexo consta de tres valores discretos que corresponden a tres clases discretas: <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">es</span> <span class="pre">hombre</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">es</span> <span class="pre">mujer</span></code> y <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">es</span> <span class="pre">otro</span></code>.</p></li>
<li><p>Cree un gráfico de caja con el eje <span class="math notranslate nohighlight">\(x\)</span> como columna de sexo y el eje <span class="math notranslate nohighlight">\(y\)</span> como peso</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">gym</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">notched</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La escala del eje <span class="math notranslate nohighlight">\(y\)</span> es extrañamente grande, ya que todos los <strong>gráficos de caja están comprimidos en la octava parte inferior del gráfico</strong>, por lo que no representa una visualización clara de los datos. Esto se debe al valor atípico en la cuarta instancia de nuestro <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> <strong>790 kg</strong></p></li>
<li><p>Todos los valores parecen estar bien, excepto ese valor atípico en la parte superior del gráfico con <strong>max=790</strong>. Ahora, veremos las formas de tratar los valores atípicos.</p></li>
</ul>
<p><strong>Cómo tratar los valores atípicos</strong></p>
<p>Hay tres formas principales de tratar los valores atípicos:</p>
<ul class="simple">
<li><p><strong>Eliminación</strong>: Si sólo hay unas pocas instancias (filas) que poseen valores atípicos, entonces esas instancias pueden ser eliminadas completamente del conjunto de datos, dejando así un conjunto de datos con cero valores atípicos. También hay ocasiones en las que una determinada característica (columna) contiene un gran número de valores atípicos. En tal caso, esa característica concreta puede eliminarse del conjunto de datos pero sólo si esa característica es insignificante. Sin embargo, la eliminación de datos no siempre es la mejor idea.</p></li>
</ul>
<ul class="simple">
<li><p><strong>Imputación</strong>: La imputación es una opción mejor que la eliminación, especialmente <strong>si hay muchos valores atípicos en el conjunto de datos</strong>. Esto puede hacerse de tres maneras:</p>
<ul>
<li><p>La forma más común es imputar los valores atípicos con la <strong>media</strong>, la <strong>mediana</strong> o la <strong>moda</strong> de la columna. Sin embargo, en el caso de muchos valores atípicos, estos valores pueden no ser lo suficientemente bueno, ya que cada valor atípico será un problema, debido a que cada uno de estos valores será sustituido por el mismo valor (la <strong>media</strong>, la <strong>mediana</strong> o la <strong>moda</strong>)</p></li>
<li><p>El otro método para obtener mejores valores para los valores atípicos, especialmente en el caso de <strong>series temporales</strong>, es la <strong>interpolación lineal</strong>, es decir, el uso de polinomios lineales para crear nuevos puntos de datos dentro de un rango definido de puntos conocidos para reemplazar valores atípicos.</p></li>
<li><p>Un modelo de <strong>regresión lineal</strong> también puede utilizarse para <strong>predecir un valor que falta si es numérico</strong>, y en el caso de que el <strong>valor que falta sea categórico</strong>, se puede utilizar un modelo de <strong>regresión logística</strong>.</p></li>
<li><p>Por ejemplo, supongamos que tiene un conjunto de datos del que necesita mostrar una relación entre la altura y el peso. La columna de la altura tiene varios valores perdidos, pero, como es una <strong>característica significativa, no puede eliminarla, ni tampoco puede imputar la media de la columna</strong>, ya que eso podría llevar a una relación falsa. El conjunto de datos puede dividirse en dos conjuntos de datos</p>
<ul>
<li><p>El conjunto de datos de entrenamiento, que contiene instancias sin valores perdidos</p></li>
<li><p>El nuevo conjunto de datos, que contiene solo los casos en los que faltan valores en la columna de altura.</p></li>
<li><p>A continuación, se puede utilizar un modelo de regresión lineal en el conjunto de datos de entrenamiento. El modelo aprenderá de estos datos y, cuando se le proporcione el nuevo conjunto de datos, podrá <strong>predecir los valores de la columna de altura</strong>. Ahora, los dos conjuntos de datos pueden fusionarse juntos y ser utilizados para crear visualizaciones, ya que no hay valores perdidos.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Transformación</strong>: Es el proceso de transformación de los valores atípicos mediante la construcción de la columna de datos en la que se encuentra el valor atípico, por ejemplo, convirtiendo los valores en porcentajes y utilizando esa columna como característica en lugar de la columna original. En la siguiente sección, veremos un ejercicio para entender cómo podemos tratar los valores atípicos.</p></li>
</ul>
</section>
<section id="como-tratar-los-valores-atipicos">
<h2>Cómo tratar los valores atípicos<a class="headerlink" href="#como-tratar-los-valores-atipicos" title="Permalink to this heading">#</a></h2>
<p><strong>Detección de valores atípicos</strong></p>
<ul class="simple">
<li><p>Si nuestro conjunto de datos es pequeño, podemos detectar el valor atípico simplemente mirando el conjunto de datos. Pero si tenemos un conjunto de datos enorme, ¿cómo podemos identificar los valores atípicos? Tenemos que utilizar técnicas de visualización y matemáticas. A continuación se presentan algunas de las técnicas de detección de valores atípicos</p>
<ul>
<li><p>Boxplots</p></li>
<li><p>Puntuación <span class="math notranslate nohighlight">\(Z\)</span></p></li>
<li><p>Rango intercuantil <strong>(IQR)</strong></p></li>
</ul>
</li>
</ul>
<p><strong>Detección de valores atípicos mediante las puntuaciones <span class="math notranslate nohighlight">\(Z\)</span></strong></p>
<ul class="simple">
<li><p><strong>Criterio</strong>: Cualquier dato cuya puntuación <span class="math notranslate nohighlight">\(Z\)</span> esté <strong>fuera de la tercera desviación estándar es un valor atípico</strong></p></li>
</ul>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/z_score.png"><img alt="_images/z_score.png" src="_images/z_score.png" style="width: 560.0px; height: 364.8px;" /></a>
</figure>
<p><strong>Implementación</strong>:</p>
<ul class="simple">
<li><p>Recorrer todos los datos y calcular la puntuación <span class="math notranslate nohighlight">\(Z\)</span> mediante la fórmula <span class="math notranslate nohighlight">\((X_{i}-\mu)/\sigma\)</span>. Definir un valor de umbral de 3 y marcar los puntos de datos cuyo valor absoluto de puntuación <span class="math notranslate nohighlight">\(Z\)</span> sea mayor que el umbral como valores atípicos.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">detect_outliers_zscore</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">thres</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">/</span><span class="n">std</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z_score</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">thres</span><span class="p">):</span>
            <span class="n">outliers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outliers</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_outliers</span> <span class="o">=</span> <span class="n">detect_outliers_zscore</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outliers from Z-scores method: &quot;</span><span class="p">,</span> <span class="n">sample_outliers</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Detección de valores atípicos mediante el rango intercuantil (IQR)</strong></p>
<ul class="simple">
<li><p><strong>Criterio</strong>: Los datos que se sitúan 1.5 veces del <strong>IQR</strong> por encima de <span class="math notranslate nohighlight">\(Q_{3}\)</span> y por debajo de <span class="math notranslate nohighlight">\(Q_{1}\)</span> son valores atípicos.</p></li>
</ul>
<p><strong>Implementación</strong></p>
<ul class="simple">
<li><p>Ordenar el conjunto de datos de forma ascendente</p></li>
<li><p>Calcular los cuartiles 1 y 3 <span class="math notranslate nohighlight">\((Q_{1}, Q_{3})\)</span></p></li>
<li><p>Calcular <span class="math notranslate nohighlight">\(IQR=Q_{3}-Q_{1}\)</span></p></li>
<li><p>Calcular el límite inferior = <span class="math notranslate nohighlight">\((Q_{1}-1.5*IQR)\)</span>, el límite superior = <span class="math notranslate nohighlight">\((Q_{3}+1.5*IQR)\)</span>, recorrer los valores del conjunto de datos y comprobar los que están por debajo del límite inferior y por encima del límite superior y marcarlos como valores atípicos</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">detect_outliers_iqr</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
    <span class="n">IQR</span> <span class="o">=</span> <span class="n">q3</span><span class="o">-</span><span class="n">q1</span>
    <span class="n">lwr_bound</span> <span class="o">=</span> <span class="n">q1</span><span class="o">-</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">)</span>
    <span class="n">upr_bound</span> <span class="o">=</span> <span class="n">q3</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span> 
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">lwr_bound</span> <span class="ow">or</span> <span class="n">i</span><span class="o">&gt;</span><span class="n">upr_bound</span><span class="p">):</span>
            <span class="n">outliers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outliers</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_outliers</span> <span class="o">=</span> <span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outliers from IQR method: &quot;</span><span class="p">,</span> <span class="n">sample_outliers</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tratamiento-de-los-valores-atipicos">
<h2>Tratamiento de los valores atípicos<a class="headerlink" href="#tratamiento-de-los-valores-atipicos" title="Permalink to this heading">#</a></h2>
<p><strong>Eliminación</strong></p>
<ul class="simple">
<li><p>En este ejercicio, vamos a eliminar la instancia que contiene el valor atípico del conjunto de datos que utilizamos en el ejercicio previo, y visualizamos el conjunto de datos de nuevo generando un gráfico de caja basado en el nuevo conjunto de datos.</p></li>
</ul>
<ul class="simple">
<li><p>Importar las librerías necesarias</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Guarda el archivo <em>gym.csv</em> en un DataFrame llamado <strong>gym</strong>, e imprime las cinco primeras filas del mismo para ver cómo son los datos</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gym</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/gym.csv&#39;</span><span class="p">)</span>
<span class="n">gym</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Modificar el DataFrame del gimnasio para que solo esté formado por los <em>casos en los que el peso sea inferior a 104</em> e imprimir las cinco primeras filas:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gym_del</span> <span class="o">=</span> <span class="n">gym</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">weight</span> <span class="o">&lt;</span> <span class="mi">104</span><span class="p">]</span>
<span class="n">gym_del</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Vamos a crear un boxplot para ver el aspecto de los datos</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">gym_del</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">notched</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">fig1</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Imputación por medio de la <em>media, mediana o moda</em></strong></p>
<ul class="simple">
<li><p>Como el <em>valor medio es sensible a valores atípicos, se aconseja sustituirlos por la mediana</em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;median: &quot;</span><span class="p">,</span> <span class="n">median</span><span class="p">)</span>

<span class="k">for</span> <span class="n">outlier</span> <span class="ow">in</span> <span class="n">sample_outliers</span><span class="p">:</span>
    <span class="n">gym</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">weight</span> <span class="o">==</span> <span class="n">outlier</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gym</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">gym</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">notched</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">fig1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tratamiento-de-los-valores-faltantes">
<h2>Tratamiento de los valores faltantes<a class="headerlink" href="#tratamiento-de-los-valores-faltantes" title="Permalink to this heading">#</a></h2>
<p><strong>Datos faltantes</strong></p>
<ul class="simple">
<li><p>Los datos perdidos son, como su nombre indica, valores que están en blanco (<strong>NaN, -, 0</strong> cuando no deberían ser <strong>0</strong>, etc.). Al igual que los valores atípicos, los valores perdidos pueden ser problemáticos tanto en el caso de las visualizaciones como en el de los modelos predictivos.</p></li>
<li><p>Los valores faltantes en las visualizaciones pueden mostrar una tendencia que en realidad no existe o no representa una relación entre dos variables que, en realidad, es significativa. Aunque es posible crear visualizaciones con un conjunto de datos que contenga valores perdidos, no se recomienda hacerlo. Al hacerlo, se ignoran los casos en los que se encuentran esos valores perdidos, creando así una visualización basada en algunos de los datos pero no en todos.</p></li>
<li><p>Por lo tanto, el tratamiento de los valores perdidos es de suma importancia. Existen dos enfoques principales para tratar los valores perdidos: <code class="docutils literal notranslate"><span class="pre">la</span> <span class="pre">supresión</span> <span class="pre">y</span> <span class="pre">la</span> <span class="pre">imputación,</span> <span class="pre">ambos</span> <span class="pre">discutidos</span> <span class="pre">en</span> <span class="pre">términos</span> <span class="pre">de</span> <span class="pre">tratamiento</span> <span class="pre">de</span> <span class="pre">los</span> <span class="pre">valores</span> <span class="pre">atípicos.</span> <span class="pre">La</span> <span class="pre">misma</span> <span class="pre">lógica</span> <span class="pre">se</span> <span class="pre">aplica</span> <span class="pre">a</span> <span class="pre">los</span> <span class="pre">valores</span> <span class="pre">faltantes</span></code>.</p></li>
</ul>
<ul class="simple">
<li><p>En este ejercicio, vamos a trabajar con un conjunto de datos que tiene <code class="docutils literal notranslate"><span class="pre">siete</span> <span class="pre">valores</span> <span class="pre">perdidos</span> <span class="pre">en</span> <span class="pre">forma</span> <span class="pre">de</span> <span class="pre">0s</span></code>. En primer lugar, <code class="docutils literal notranslate"><span class="pre">eliminaremos</span> <span class="pre">las</span> <span class="pre">instancias</span> <span class="pre">que</span> <span class="pre">contienen</span> <span class="pre">estos</span> <span class="pre">valores</span> <span class="pre">perdidos</span> <span class="pre">y</span> <span class="pre">se</span> <span class="pre">genera</span> <span class="pre">un</span> <span class="pre">gráfico</span> <span class="pre">de</span> <span class="pre">caja</span> <span class="pre">para</span> <span class="pre">ver</span> <span class="pre">el</span> <span class="pre">impacto</span> <span class="pre">que</span> <span class="pre">la</span> <span class="pre">eliminación</span> <span class="pre">de</span> <span class="pre">un</span> <span class="pre">gran</span> <span class="pre">número</span> <span class="pre">de</span> <span class="pre">instancias</span> <span class="pre">en</span> <span class="pre">nuestra</span> <span class="pre">visualización</span></code>. A continuación, imputaremos el valor de la mediana de la columna que contiene los valores perdidos y generaremos un gráfico de caja basado en este conjunto de datos imputados.</p></li>
</ul>
<ul class="simple">
<li><p>Importar las librerías necesarias</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Guarda el archivo <em>weight.csv</em> en un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> llamado <strong>weight</strong>, e imprime las cinco primeras filas del mismo para ver cómo son los datos y utiliza la función <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> para mostrar información sobre ella</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/weight.csv&#39;</span><span class="p">)</span>
<span class="n">w</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Como podemos ver, el valor de peso mínimo en nuestro conjunto de datos es <strong>0</strong>; sin embargo, nadie puede pesar <strong>0 kgs</strong>, lo que significa que tenemos valores faltantes en forma de <strong>0s</strong>. Intentemos eliminar estas instancias.</p></li>
<li><p>Cree un nuevo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que conste sólo de las instancias en las que el peso no sea igual a <strong>0</strong>. Muestre información sobre este nuevo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doc_w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">weight</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">doc_w</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Crea un <code class="docutils literal notranslate"><span class="pre">boxplot</span></code> con este nuevo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, con el eje <span class="math notranslate nohighlight">\(x\)</span> como sexo y el eje <span class="math notranslate nohighlight">\(y\)</span> como peso</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">doc_w</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">notched</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">fig1</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Ahora, el valor del peso mínimo es 21, lo que tiene más sentido. Sin embargo, nuestro conteo se ha reducido a <code class="docutils literal notranslate"><span class="pre">55</span> <span class="pre">de</span> <span class="pre">62,</span> <span class="pre">lo</span> <span class="pre">que</span> <span class="pre">significa</span> <span class="pre">que</span> <span class="pre">se</span> <span class="pre">han</span> <span class="pre">eliminado</span> <span class="pre">7</span> <span class="pre">instancias</span> <span class="pre">de</span> <span class="pre">nuestro</span> <span class="pre">conjunto</span> <span class="pre">de</span> <span class="pre">datos</span></code>. Esto puede parecer pequeño en este ejemplo, pero en realidad, esto puede tener repercusiones serias en la información obtenida.</p></li>
<li><p>Además, en el gráfico de caja anterior, el extremo inferior de la caja para el sexo 0 y el extremo superior de la caja para el sexo 2 es ligeramente anormal. Por lo tanto, sustituyamos los valores 0 de la columna de peso por el valor medio de la columna. Recuerde que tenemos que calcular la media de la columna <strong>¡columna sin tener en cuenta esos valores 0!</strong> Si los tenemos en cuenta, entonces nuestra media será incorrecta.</p></li>
</ul>
<ul class="simple">
<li><p>Calcular la media de la columna de pesos del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que consiste en sólo valores de peso distintos de cero</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">median_w</span> <span class="o">=</span> <span class="n">doc_w</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">median_w</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Utilice la función <code class="docutils literal notranslate"><span class="pre">.replace()</span></code> para sustituir los valores <strong>0</strong> presentes en la columna <strong>weight</strong> del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> original por la mediana de la columna <strong>weight</strong> del modificado. Guarde esto en un nuevo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_new</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">median_w</span><span class="p">}})</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Muestra la información del nuevo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_new</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Nuestro recuento es de 62, lo que significa que tenemos todas las instancias, y nuestro peso mínimo es 21, lo que significa que no tenemos ningún <strong>0</strong>.</p></li>
<li><p>Cree un gráfico de caja con este nuevo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, con el eje <span class="math notranslate nohighlight">\(x\)</span> como <strong>sex</strong> y el eje <span class="math notranslate nohighlight">\(y\)</span> como <strong>weight</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig2</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">w_new</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">notched</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">fig2</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="imputacion-multiple-iterativa">
<h2>Imputación múltiple iterativa<a class="headerlink" href="#imputacion-multiple-iterativa" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Ahora, tenemos una visualización que no tiene valores perdidos y representa todas las instancias que están presentes en el conjunto de datos. Veamos el tercer problema que puede generar una visualización defectuosa. <strong>Otras técnicas de imputación de datos fueron estudiadas en R, y se pueden importar a Python</strong>. En Python, <code class="docutils literal notranslate"><span class="pre">MICE</span></code> se puede ejecutar en un paquete llamado <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.IterativeImputer.html">IterativeImputer</a>, el cual está en fase experimental y está disponible en el paquete <code class="docutils literal notranslate"><span class="pre">sklearn.impute</span></code>.</p></li>
<li><p>La siguiente figura describe como funciona la imputación múltiple iterativa, la cual seguiremos analizando también usando el lenguaje <code class="docutils literal notranslate"><span class="pre">R</span></code></p></li>
</ul>
<figure class="align-center" id="multiple-imputation-fig">
<img alt="_images/multiple_imputation.png" src="_images/multiple_imputation.png" />
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Funcionamiento del método de imputación múltiple por ecuaciones encadenadas.</span><a class="headerlink" href="#multiple-imputation-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="pmm-imputation-fig">
<img alt="_images/pmm_imputation.png" src="_images/pmm_imputation.png" />
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Funcionamiento del método de imputación por emparejamiento predictivo medio.</span><a class="headerlink" href="#pmm-imputation-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="aplicacion-de-iterativeimputer">
<h2>Aplicación de IterativeImputer<a class="headerlink" href="#aplicacion-de-iterativeimputer" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>El conjunto de datos del presente ejemplo, describe las características médicas de caballos con cólico y si sobrevivieron o murieron (ver <a class="reference external" href="https://raw.githubusercontent.com/lihkir/Data/main/horse-colic.names.txt">horse-colic</a>). Hay 300 filas y 26 variables de entrada con una variable de salida. Es una tarea de predicción de <strong>clasificación binaria</strong> que implica predecir <em>1 si el caballo vivió y 2 si el caballo murió</em>.</p></li>
<li><p>Hay muchos campos que podríamos seleccionar para predecir en este conjunto de datos. En este caso, <strong>predeciremos si el problema fue quirúrgico o no (índice de columna 23)</strong>, convirtiéndolo en un problema de clasificación binaria. El conjunto de datos tiene muchos valores faltantes para muchas de las columnas, donde <strong>cada valor faltante está marcado con un carácter de interrogación (“?”)</strong>.</p></li>
</ul>
<ul class="simple">
<li><p>Podemos cargar el conjunto de datos usando la función <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> y especificar los <code class="docutils literal notranslate"><span class="pre">na_values</span></code> para cargar los valores de <code class="docutils literal notranslate"><span class="pre">'?'</span></code> como datos faltantes, marcados con un valor <code class="docutils literal notranslate"><span class="pre">NaN</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/lihkir/Data/main/horse-colic.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Luego podemos enumerar cada columna y reportar el <em>número de filas con valores faltantes para esa columna</em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
 <span class="n">n_miss</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
 <span class="n">perc</span> <span class="o">=</span> <span class="n">n_miss</span> <span class="o">/</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; </span><span class="si">%d</span><span class="s1">, Missing: </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%.1f%%</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n_miss</span><span class="p">,</span> <span class="n">perc</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Podemos observar que algunas columnas (por ejemplo, los índices de <em>columna 1 y 2) no tienen valores faltantes</em>, mientras que otras columnas (por ejemplo, los índices de <em>columna 15 y 21) tienen muchos o incluso la mayoría de los valores faltantes</em>.</p></li>
</ul>
<ul class="simple">
<li><p><strong>Transformación de Datos con IterativeImputer</strong>: Es una transformación de datos configurada según el método utilizado para estimar los valores faltantes. Por defecto, se emplea un modelo <code class="docutils literal notranslate"><span class="pre">BayesianRidge()</span></code> que utiliza una función de todas las demás características de entrada. <strong>Las características se completan en orden ascendente, desde aquellas con menos valores faltantes hasta aquellas con más</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">isnan</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">n_nearest_features</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">imputation_order</span><span class="o">=</span><span class="s1">&#39;ascending&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">values</span>
<span class="n">ix</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">23</span><span class="p">]</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">23</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Missing: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">sum</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>El imputador se ajusta a un conjunto de datos. Luego, <strong>el imputador ajustado se aplica a un conjunto de datos para crear una copia del conjunto de datos con todos los valores faltantes de cada columna reemplazados por un valor estimado</strong>. La clase <code class="docutils literal notranslate"><span class="pre">IterativeImputer</span></code> no se puede utilizar directamente porque es experimental.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">()</span>
<span class="n">imputer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Xtrans</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Missing: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">sum</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">Xtrans</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="iterativeimputer-y-evaluacion-de-modelos">
<h2>IterativeImputer y evaluación de modelos<a class="headerlink" href="#iterativeimputer-y-evaluacion-de-modelos" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Para aplicar correctamente la imputación iterativa de datos faltantes y <strong>evitar la fuga de datos</strong>, se crea un <code class="docutils literal notranslate"><span class="pre">pipeline</span></code> de modelado donde el <strong>primer paso sea la imputación iterativa</strong>, y el <strong>segundo paso sea el modelo</strong>. Esto se puede lograr utilizando la clase <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code>. Por ejemplo, el <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> a continuación utiliza un <code class="docutils literal notranslate"><span class="pre">IterativeImputer</span></code> con la estrategia predeterminada, seguido de un <strong>modelo de bosque aleatorio</strong>.</p></li>
<li><p>Podemos evaluar el conjunto de datos imputado y el <code class="docutils literal notranslate"><span class="pre">pipeline</span></code> de modelado de bosque aleatorio para el conjunto de datos con <em>validación cruzada</em> repetida de 10 pliegues.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">mean</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">std</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RepeatedStratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">()</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">imputer</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">model</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/horse-colic.csv&#39;</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">values</span>
<span class="n">ix</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">23</span><span class="p">]</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">23</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">()</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">imputer</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">model</span><span class="p">)])</span>

<span class="n">cv</span> <span class="o">=</span> <span class="n">RepeatedStratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Accuracy: </span><span class="si">%.3f</span><span class="s1"> (</span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Los resultados pueden variar debido a la naturaleza estocástica del algoritmo o del procedimiento de evaluación, o diferencias en la precisión numérica</strong>. Considera ejecutar el ejemplo varias veces y comparar el resultado promedio.</p></li>
<li><p>El pipeline se evalúa utilizando tres repeticiones de validación cruzada de 10 pliegues y reporta una precisión media de clasificación en el conjunto de datos de aproximadamente 86.3 por ciento, lo cual es un buen puntaje. <strong>¿Cómo sabemos que usar una estrategia iterativa predeterminada es buena o la mejor para este conjunto de datos?</strong></p></li>
</ul>
</section>
<section id="iterativeimputer-y-diferente-orden-de-imputacion">
<h2>IterativeImputer y diferente orden de imputación<a class="headerlink" href="#iterativeimputer-y-diferente-orden-de-imputacion" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Por defecto, la imputación se realiza en <em>orden ascendente, desde la característica con menos valores faltantes hasta la característica con más valores faltantes</em>. Sin embargo, podemos experimentar con diferentes estrategias de orden de imputación, como <strong>descendente, de derecha a izquierda (árabe), de izquierda a derecha (romano) y aleatorio</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">mean</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">std</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RepeatedStratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">values</span>
<span class="n">ix</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">23</span><span class="p">]</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">strategies</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;descending&#39;</span><span class="p">,</span> <span class="s1">&#39;roman&#39;</span><span class="p">,</span> <span class="s1">&#39;arabic&#39;</span><span class="p">,</span> <span class="s1">&#39;random&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
 <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">imputation_order</span><span class="o">=</span><span class="n">s</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">())])</span>
 <span class="n">cv</span> <span class="o">=</span> <span class="n">RepeatedStratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> (</span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">strategies</span><span class="p">,</span> <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Los resultados sugieren <em>pocas diferencias entre la mayoría de los métodos</em>, con el orden descendente (opuesto al predeterminado) obteniendo el mejor rendimiento. Los resultados sugieren que el <strong>orden árabe (de derecha a izquierda) o romano podría ser mejor para este conjunto de datos</strong> con una precisión de aproximadamente 87.2 por ciento.</p></li>
</ul>
</section>
<section id="iterativeimputer-y-diferente-numero-de-iteraciones">
<h2>IterativeImputer y diferente número de iteraciones<a class="headerlink" href="#iterativeimputer-y-diferente-numero-de-iteraciones" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Por defecto, <code class="docutils literal notranslate"><span class="pre">IterativeImputer</span></code> repetirá el número de iteraciones 10 veces. Es posible que un <strong>gran número de iteraciones comience a sesgar o distorsionar la estimación y que se prefieran pocas iteraciones</strong>. El número de iteraciones del procedimiento se puede especificar mediante el argumento <code class="docutils literal notranslate"><span class="pre">&quot;max_iter&quot;</span></code>. El siguiente ejemplo compara diferentes valores para <code class="docutils literal notranslate"><span class="pre">&quot;max_iter&quot;</span></code> desde 1 hasta 20.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">mean</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">std</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RepeatedStratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">values</span>
<span class="n">ix</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">23</span><span class="p">]</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">strategies</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
	<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">))),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">())])</span>
	<span class="n">cv</span> <span class="o">=</span> <span class="n">RepeatedStratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> (</span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">strategies</span><span class="p">,</span> <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Los resultados sugieren que <strong>muy pocas iteraciones, como 3, podrían ser igual de efectivas o más que 9-12 iteraciones</strong> en este conjunto de datos.</p></li>
</ul>
</section>
<section id="iterativeimputer-al-hacer-una-prediccion">
<h2>IterativeImputer al hacer una predicción<a class="headerlink" href="#iterativeimputer-al-hacer-una-prediccion" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Podemos desear crear un <code class="docutils literal notranslate"><span class="pre">pipeline</span></code> de modelado final <em>con la imputación iterativa y el algoritmo de bosque aleatorio</em>, y luego hacer una predicción para nuevos datos. Esto se puede lograr definiendo el <code class="docutils literal notranslate"><span class="pre">pipeline</span></code> y ajustándolo en todos los datos disponibles, luego llamando a la función <code class="docutils literal notranslate"><span class="pre">predict()</span></code>, pasando los nuevos datos como argumento. Es importante destacar que la fila de nuevos datos debe marcar cualquier valor faltante utilizando el valor <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">IterativeImputer</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">())])</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">530101</span><span class="p">,</span> <span class="mf">38.50</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">45.00</span><span class="p">,</span> <span class="mf">8.40</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11300</span><span class="p">,</span> <span class="mi">00000</span><span class="p">,</span> <span class="mi">00000</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yhat</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">row</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicted Class: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">yhat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="instancias-y-o-funciones-duplicadas">
<h2>Instancias y/o funciones duplicadas<a class="headerlink" href="#instancias-y-o-funciones-duplicadas" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>El tercer problema es la presencia de <code class="docutils literal notranslate"><span class="pre">instancias</span> <span class="pre">y/o</span> <span class="pre">características</span> <span class="pre">duplicadas</span> <span class="pre">en</span> <span class="pre">un</span> <span class="pre">conjunto</span> <span class="pre">de</span> <span class="pre">datos</span></code>. Se trata de elementos innecesarios en el conjunto de datos y, si no se eliminan, <em>pueden afectar a las tendencias y a los conocimientos que se muestran en una visualización</em>.</p></li>
<li><p>Por ejemplo, puede crear una visualización que muestre la relación entre el género de un adolescente y si toca el piano. Con un conjunto de datos sin valores atípicos, anomalías o valores perdidos, obtendrá una gran visualización.</p></li>
<li><p>A partir de la visualización, podrá también concluir que <strong>hay más mujeres que tocan el piano que hombres</strong>. Sin embargo, digamos que la visualización proviene del conjunto de datos siguiente</p></li>
</ul>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/Figure714.png"><img alt="_images/Figure714.png" src="_images/Figure714.png" style="width: 469.6px; height: 284.0px;" /></a>
</figure>
<ul class="simple">
<li><p>Hay dos instancias para <strong>Nita Thadaka</strong> y tres instancias para <strong>Pooja Rajesh</strong>, lo que significa que hay <code class="docutils literal notranslate"><span class="pre">tres</span> <span class="pre">instancias</span> <span class="pre">duplicadas</span> <span class="pre">en</span> <span class="pre">total</span></code>. Esto significa que la información que la visualización está proporcionando es inexacta. La forma de tratar los duplicados es sencilla: <strong>eliminarlos</strong>. Con este fin puede utlizar la función: <code class="docutils literal notranslate"><span class="pre">.drop_duplicates()</span></code></p></li>
</ul>
</section>
<section id="mala-seleccion-de-caracteristicas">
<h2>Mala selección de características<a class="headerlink" href="#mala-seleccion-de-caracteristicas" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Con respecto a un conjunto de datos, una característica es una columna en el conjunto de datos, mientras que una instancia es una fila en el conjunto de datos. Por ejemplo, en la tabla anterior, nombre, sexo, tocar el piano y la edad son características, mientras que Pooja Rajesh, F, Yes y 17 es una instancia.</p></li>
<li><p>Dado que el objetivo de una visualización es mostrar una tendencia, un patrón, una relación o algún vínculo entre dos o más características en un conjunto de datos, <code class="docutils literal notranslate"><span class="pre">es</span> <span class="pre">importante</span> <span class="pre">que</span> <span class="pre">la</span> <span class="pre">selección</span> <span class="pre">de</span> <span class="pre">esas</span> <span class="pre">características</span> <span class="pre">se</span> <span class="pre">haga</span> <span class="pre">con</span> <span class="pre">cuidado</span></code>. Por lo tanto, este es un punto crucial en la visualización de datos.</p></li>
<li><p>Si el objetivo es transmitir que existe una fuerte relación entre dos características, entonces hay que <code class="docutils literal notranslate"><span class="pre">asegurarse</span> <span class="pre">de</span> <span class="pre">que</span> <span class="pre">están</span> <span class="pre">fuertemente</span> <span class="pre">correlacionadas</span> <span class="pre">antes</span> <span class="pre">de</span> <span class="pre">proceder</span> <span class="pre">a</span> <span class="pre">su</span> <span class="pre">visualización</span></code>. La selección de características insignificantes dará lugar a una visualización sin sentido y no transmitirá ninguna información concreta. Por ejemplo, en cuanto al conjunto de datos <a class="reference external" href="https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/co2.csv">co2.csv</a>, el conjunto de datos contiene información sobre las emisiones de dióxido de carbono por país y el PIB por país. Comprobamos la <code class="docutils literal notranslate"><span class="pre">correlación</span> <span class="pre">entre</span> <span class="pre">las</span> <span class="pre">emisiones</span> <span class="pre">de</span> <span class="pre">CO2</span> <span class="pre">y</span> <span class="pre">el</span> <span class="pre">PIB</span> <span class="pre">antes</span> <span class="pre">de</span> <span class="pre">visualizar</span> <span class="pre">el</span> <span class="pre">conjunto</span> <span class="pre">de</span> <span class="pre">datos,</span> <span class="pre">garantizando</span> <span class="pre">que</span> <span class="pre">íbamos</span> <span class="pre">a</span> <span class="pre">crear</span> <span class="pre">una</span> <span class="pre">una</span> <span class="pre">visualización</span> <span class="pre">que</span> <span class="pre">valiera</span> <span class="pre">la</span> <span class="pre">pena</span></code>.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ejercicio-para-entregar">
<h1>Ejercicio para entregar<a class="headerlink" href="#ejercicio-para-entregar" title="Permalink to this heading">#</a></h1>
<ol class="arabic">
<li><p>Determine las características que se visualizan en un gráfico de dispersión. Se le da el conjunto de datos <a class="reference external" href="https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/co2.csv">co2.csv</a> y se le pide que proporcione información sobre él, como por ejemplo, qué tipo de patrones existen, si hay tendencias entre las características, etc. Es necesario que su visualización final transmita información significativa. Para conseguirlo, va a crear visualizaciones para diferentes emparejamientos de características para entender están correlacionadas y, por lo tanto, vale la pena visualizarlas.</p>
<p><strong>Pasos principales</strong></p>
<ul class="simple">
<li><p>Importe las bibliotecas necesarias.</p></li>
<li><p>Vuelva a crear el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. Desde el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> <code class="docutils literal notranslate"><span class="pre">gm</span></code> incluya las columnas <code class="docutils literal notranslate"><span class="pre">population</span></code>, <code class="docutils literal notranslate"><span class="pre">fertility</span></code>, y <code class="docutils literal notranslate"><span class="pre">life</span></code></p></li>
<li><p>Visualiza la relación entre el <code class="docutils literal notranslate"><span class="pre">co2</span></code> y <code class="docutils literal notranslate"><span class="pre">life</span></code> utilizando un gráfico de dispersión, con el nombre del país como información en la herramienta hover y el año como deslizador.</p></li>
<li><p>Comprueba la correlación entre <code class="docutils literal notranslate"><span class="pre">co2</span></code> y <code class="docutils literal notranslate"><span class="pre">life</span></code>.</p></li>
<li><p>Visualiza la relación entre <code class="docutils literal notranslate"><span class="pre">co2</span></code> y <code class="docutils literal notranslate"><span class="pre">fertility</span></code> mediante un gráfico de dispersión, con el nombre del país como información en la herramienta hover y el año como deslizador.</p></li>
<li><p>Comprueba la correlación entre <code class="docutils literal notranslate"><span class="pre">co2</span></code> y <code class="docutils literal notranslate"><span class="pre">fertility</span></code></p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Realicé un EDA para el siguiente conjunto de datos (ver <a class="reference external" href="https://raw.githubusercontent.com/lihkir/Data/main/diabetes.csv">Diabetes Dataset</a>). El conjunto de datos consta de varias variables médicas predictoras (independientes) y una variable objetivo (<em>diagnóstico</em>, dependiente), resultado. Las variables independientes incluyen el número de embarazos que ha tenido la paciente, BMI (<code class="docutils literal notranslate"><span class="pre">Body</span> <span class="pre">mass</span> <span class="pre">index</span></code> (peso en <code class="docutils literal notranslate"><span class="pre">kg/(height</span> <span class="pre">in</span> <span class="pre">m)^2</span></code>), nivel de insulina, edad, etc. En este dataset, sustituimos todos los valores nulos “faltantes” por NAN y realizamos el respectivo análisis de datos faltantes.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Glucose&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;Glucose&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NAN</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;BloodPressure&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;BloodPressure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NAN</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;SkinThickness&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;SkinThickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NAN</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Insulin&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;Insulin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NAN</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;BMI&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;BMI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NAN</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Aplique imputación de datos usando las diferentes opciones de estimadores (ver <a class="reference external" href="https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values">estimators-that-handle-nan-values</a>). Identifique si el problema es de clasificación o regresión previamente.</p></li>
<li><p>Identifique datos atípicos para cada variable en el dataset usando las técnicas estudiadas en clase. Además, realice imputación de los datos atípicos con base en lo desarrollado en el ítem anterior (ver <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.IterativeImputer.html">IterativeImputer</a>).</p>
<ul>
<li><p>Imputación/Capping/Predicción</p></li>
<li><p>Use los siguientes tests para detectar valores atípicos: Test de Rosner, Dixon, Grubbs, Hampel, Percentiles, Boxplots, Histograms, Descriptivos</p></li>
</ul>
</li>
</ul>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "ml_tf"
        },
        kernelOptions: {
            name: "ml_tf",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ml_tf'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="geo_dataviz.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Visualización interactiva de datos geográficos</p>
      </div>
    </a>
    <a class="right-next"
       href="predictive_model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Predicción de series de tiempo</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Errores comunes al crear visualizaciones interactivas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">Introducción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formato-e-interpretacion-de-datos">Formato e interpretación de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-valores-atipicos-en-un-conjunto-de-datos-con-un-grafico-de-cajas">Visualización de valores atípicos en un conjunto de datos con un gráfico de cajas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#como-tratar-los-valores-atipicos">Cómo tratar los valores atípicos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamiento-de-los-valores-atipicos">Tratamiento de los valores atípicos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamiento-de-los-valores-faltantes">Tratamiento de los valores faltantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-multiple-iterativa">Imputación múltiple iterativa</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-de-iterativeimputer">Aplicación de IterativeImputer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativeimputer-y-evaluacion-de-modelos">IterativeImputer y evaluación de modelos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativeimputer-y-diferente-orden-de-imputacion">IterativeImputer y diferente orden de imputación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativeimputer-y-diferente-numero-de-iteraciones">IterativeImputer y diferente número de iteraciones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterativeimputer-al-hacer-una-prediccion">IterativeImputer al hacer una predicción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instancias-y-o-funciones-duplicadas">Instancias y/o funciones duplicadas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mala-seleccion-de-caracteristicas">Mala selección de características</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-para-entregar">Ejercicio para entregar</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lihki Rubio PhD in Mathematical Engineering
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright Department of Mathematics and Statistics.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>